---
import '../styles/global.css';
import { config } from '../config';

interface Props {
  title?: string;
  description?: string;
  hideNav?: boolean;
  bodyClass?: string;
}

const {
  title = config.site.title,
  description = config.site.description,
  hideNav = false,
  bodyClass = ''
} = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={config.site.ogImage} />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;1,300;1,400&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
    <title>{title}</title>
  </head>
  <body class={bodyClass}>
    {!hideNav && (
      <nav class="nav" id="main-nav">
        <div class="container">
          <div class="flex items-center justify-between">
            <a href="/" class="nav-link font-serif text-lg tracking-wider">
              {config.couple.person1.name} & {config.couple.person2.name}
            </a>

            <!-- Desktop Navigation -->
            <div class="hidden md:flex items-center gap-8">
              <a href="#story" class="nav-link">Story</a>
              <a href="#events" class="nav-link">Events</a>
              <a href="#gallery" class="nav-link">Gallery</a>
              <a href="#messages" class="nav-link">Wishes</a>
              <a href="#rsvp" class="nav-link">RSVP</a>
            </div>

            <!-- Mobile Menu Button -->
            <button
              class="md:hidden nav-link p-2"
              id="mobile-menu-btn"
              aria-label="Open menu"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
              </svg>
            </button>
          </div>
        </div>
      </nav>

      <!-- Mobile Menu -->
      <div class="mobile-menu" id="mobile-menu">
        <button
          class="absolute top-6 right-6 p-2 text-2xl"
          id="mobile-menu-close"
          aria-label="Close menu"
        >
          &times;
        </button>
        <a href="#story" class="nav-link">Story</a>
        <a href="#events" class="nav-link">Events</a>
        <a href="#gallery" class="nav-link">Gallery</a>
        <a href="#messages" class="nav-link">Wishes</a>
        <a href="#rsvp" class="nav-link">RSVP</a>
      </div>
    )}

    <slot />

    <footer class="bg-secondary py-12">
      <div class="container text-center">
        <p class="font-serif text-2xl mb-2">
          {config.couple.person1.name} & {config.couple.person2.name}
        </p>
        <p class="text-muted text-sm">
          {new Date(config.weddingDate).toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
          })}
        </p>
      </div>
    </footer>

    <script>
      // Navigation scroll effect
      const nav = document.getElementById('main-nav');
      if (nav) {
        window.addEventListener('scroll', () => {
          if (window.scrollY > 50) {
            nav.classList.add('scrolled');
          } else {
            nav.classList.remove('scrolled');
          }
        });
      }

      // Mobile menu toggle
      const mobileMenuBtn = document.getElementById('mobile-menu-btn');
      const mobileMenuClose = document.getElementById('mobile-menu-close');
      const mobileMenu = document.getElementById('mobile-menu');

      if (mobileMenuBtn && mobileMenu && mobileMenuClose) {
        mobileMenuBtn.addEventListener('click', () => {
          mobileMenu.classList.add('is-open');
          document.body.style.overflow = 'hidden';
        });

        mobileMenuClose.addEventListener('click', () => {
          mobileMenu.classList.remove('is-open');
          document.body.style.overflow = '';
        });

        // Close menu on link click
        mobileMenu.querySelectorAll('a').forEach(link => {
          link.addEventListener('click', () => {
            mobileMenu.classList.remove('is-open');
            document.body.style.overflow = '';
          });
        });
      }

      // Scroll animations
      const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.1
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
          }
        });
      }, observerOptions);

      // Observe all animated elements
      document.querySelectorAll('.animate-on-scroll, .slide-from-left, .slide-from-right, .scale-up, .stagger-children').forEach(el => {
        observer.observe(el);
      });
    </script>
  </body>
</html>
